# yaml-language-server: $schema=https://goreleaser.com/static/schema.json
# vim: set ts=2 sw=2 tw=0 fo=jcroql
version: 2

before:
  hooks:
  - go mod download

builds:
- id: kubectl-permissions
  main: ./cmd/kubectl-permissions.go
  binary: kubectl-permissions
  ldflags:
    - -X github.com/garethjevans/kubectl-permissions/pkg/version.Version={{.Version}}
  env:
  - CGO_ENABLED=0
  goos:
  - linux
  - darwin
  - windows
  goarch:
  - amd64
  - arm64
  ignore:
  - goos: windows
    goarch: arm64

source:
  enabled: true

sboms:
- artifacts: archive
- id: source
  artifacts: source

checksum:
  name_template: 'checksums.txt'

archives:
- ids: [ 'kubectl-permissions' ]
  name_template: "{{ .ProjectName }}_{{ .Tag }}_{{ .Os }}_{{ .Arch }}{{ if .Arm }}v{{ .Arm }}{{ end }}"
  wrap_in_directory: false
  formats: [ 'tar.gz' ]
  files:
  - LICENSE
